<mat-card class="trip-dialog-card">
  <mat-card-content>
    <form [formGroup]="form">
      <div class="row">
        <mat-form-field appearance="outline" class="flex">
          <mat-label>Bus</mat-label>
          <mat-select formControlName="busId">
            <mat-option *ngFor="let b of buses" [value]="b.id">{{
              b.name || b.id
            }}</mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field appearance="outline" class="flex">
          <mat-label>Operator</mat-label>
          <input matInput formControlName="operator" />
        </mat-form-field>
      </div>

      <div class="row">
        <mat-form-field appearance="outline" class="flex">
          <mat-label>Departure Name</mat-label>
          <input matInput formControlName="departureName" />
        </mat-form-field>
        <mat-form-field appearance="outline" class="flex">
          <mat-label>Departure Time (HH:mm)</mat-label>
          <input matInput type="time" formControlName="departureTime" />
        </mat-form-field>
      </div>

      <div class="row">
        <mat-form-field appearance="outline" class="flex">
          <mat-label>Destination Name</mat-label>
          <input matInput formControlName="destinationName" />
        </mat-form-field>
        <div class="flex row">
          <mat-form-field appearance="outline" class="flex">
            <mat-label>Duration Hours</mat-label>
            <input
              matInput
              type="number"
              min="0"
              formControlName="durationHours"
            />
          </mat-form-field>
          <mat-form-field appearance="outline" class="flex">
            <mat-label>Duration Minutes</mat-label>
            <input
              matInput
              type="number"
              min="0"
              max="59"
              formControlName="durationMinutes"
            />
          </mat-form-field>
        </div>
      </div>

      <div class="row">
        <mat-form-field appearance="outline" class="flex">
          <mat-label>Adult Price</mat-label>
          <input matInput type="number" formControlName="adult" />
        </mat-form-field>
        <mat-form-field appearance="outline" class="flex">
          <mat-label>Child Price</mat-label>
          <input matInput type="number" formControlName="child" />
        </mat-form-field>
      </div>

      <div class="dates-row full">
        <mat-form-field appearance="outline" class="flex">
          <mat-label>Add date</mat-label>
          <input
            matInput
            [matDatepicker]="picker"
            #dateInput
            (dateChange)="addDate($event.value, dateInput); picker.open()"
          />
          <mat-datepicker-toggle
            matSuffix
            [for]="picker"
          ></mat-datepicker-toggle>
          <mat-datepicker #picker></mat-datepicker>
        </mat-form-field>
        <button mat-stroked-button color="primary" (click)="picker.open()">
          Add
        </button>
      </div>

      <div class="chip-list full" aria-label="Selected dates">
        <span class="chip" *ngFor="let d of selectedDates">
          <div class="chip-text">
            {{ d.date }} — {{ d.departTime }} → {{ d.arriveTime }}
          </div>
          <button
            type="button"
            class="chip-remove"
            (click)="removeDate(d.date)"
          >
            ✕
          </button>
        </span>
      </div>
    </form>
  </mat-card-content>
  <mat-card-actions align="end">
    <button mat-button (click)="close()">Cancel</button>
    <button
      mat-raised-button
      color="primary"
      (click)="save()"
      [disabled]="form.invalid"
    >
      Save
    </button>
  </mat-card-actions>
</mat-card>
